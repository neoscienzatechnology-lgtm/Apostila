<!DOCTYPE html>
<html lang="pt-BR">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<title>Aula 3.4 - Eventos e Formulários</title>
	<script src="https://cdn.tailwindcss.com"></script>
	<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet">
	<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
	<style>
		@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');
		body{font-family:'Poppins',sans-serif}
		.code-example{background:#2d3748;border-radius:8px}
	</style>
</head>
<body class="bg-yellow-50 min-h-screen py-8">
	<div class="container mx-auto max-w-4xl px-4">
		<header class="mb-6">
			<div class="bg-white rounded-2xl shadow p-6">
				<h1 class="text-3xl font-bold text-yellow-800">Aula 3.4: Eventos e Formulários</h1>
				<p class="text-gray-600 mt-2">Como lidar com eventos DOM, formulários, validação e padrões para manter código limpo e acessível.</p>
			</div>
		</header>

		<section class="bg-white rounded-2xl shadow p-6 mb-6">
			<h2 class="text-2xl font-semibold mb-3">1. Fundamentos de eventos</h2>
			<p class="text-gray-700">Eventos são a forma de reagir a ações do usuário e mudanças do sistema.</p>
			<div class="code-example p-4 mt-3"><pre><code class="language-js">// adicionar listener
const btn = document.querySelector('#meu-btn');
function onClick(e) {
	console.log('clicou', e.target);
}
btn.addEventListener('click', onClick);

// remover listener
btn.removeEventListener('click', onClick);</code></pre></div>
			<p class="text-gray-700 mt-3">Evite listeners anônimos quando precisar removê-los. Conheça bubbling e capturing (o terceiro argumento de addEventListener).</p>
		</section>

		<section class="bg-white rounded-2xl shadow p-6 mb-6">
			<h2 class="text-2xl font-semibold mb-3">2. O objeto Event</h2>
			<div class="code-example p-4"><pre><code class="language-js">element.addEventListener('click', (e) =&gt; {
	console.log(e.type, e.target);
	e.preventDefault(); // evita comportamento padrão (ex: seguir link, submit)
	e.stopPropagation(); // impede bubbling adicional
});</code></pre></div>
			<p class="text-gray-700 mt-3">Use preventDefault para controlar comportamento nativo e stopPropagation com cuidado (pode quebrar expectativas de componentes).</p>
		</section>

		<section class="bg-white rounded-2xl shadow p-6 mb-6">
			<h2 class="text-2xl font-semibold mb-3">3. Delegação e performance</h2>
			<p class="text-gray-700">Delegue eventos a um ancestor quando muitos elementos compartilham comportamento ou elementos são dinâmicos.</p>
			<div class="code-example p-4"><pre><code class="language-js">// Delegação exemplo
document.querySelector('#lista').addEventListener('click', (e) =&gt; {
	const btn = e.target.closest('button.remover');
	if (!btn) return;
	const li = btn.closest('li');
	li.remove();
});</code></pre></div>
		</section>

		<section class="bg-white rounded-2xl shadow p-6 mb-6">
			<h2 class="text-2xl font-semibold mb-3">4. Formulários — APIs modernas</h2>
			<p class="text-gray-700">Form elements e o submit do form têm comportamento padrão; controle com JavaScript e use a Constraint Validation API para validações nativas.</p>
			<div class="code-example p-4"><pre><code class="language-js">const form = document.querySelector('#meuForm');
form.addEventListener('submit', (e) =&gt; {
	e.preventDefault();
	const data = new FormData(form);
	const obj = Object.fromEntries(data.entries());
	// executar validação custom
	console.log(obj);
});

// Constraint validation
const input = document.querySelector('input[name="email"]');
if (!input.checkValidity()) {
	console.log(input.validationMessage);
}
</code></pre></div>
			<p class="text-gray-700 mt-3">FormData facilita serializar dados; use fetch para enviar. Para formulários complexos, separar validação em camadas (HTML constraints, validação JS, validação no backend).</p>
		</section>

		<section class="bg-white rounded-2xl shadow p-6 mb-6">
			<h2 class="text-2xl font-semibold mb-3">5. Eventos de input e otimizações</h2>
			<p class="text-gray-700">Eventos como input/keyup/shown podem disparar muitas vezes — use debounce/throttle para evitar trabalho excessivo.</p>
			<div class="code-example p-4"><pre><code class="language-js">// debounce (revisão)
function debounce(fn, wait) {
	let timer;
	return (...args) =&gt; {
		clearTimeout(timer);
		timer = setTimeout(() =&gt; fn.apply(this, args), wait);
	};
}

const search = document.querySelector('#search');
search.addEventListener('input', debounce((e) =&gt; {
	// busca remota / filtragem local
	console.log('buscar por', e.target.value);
}, 300));</code></pre></div>
		</section>

		<section class="bg-white rounded-2xl shadow p-6 mb-6">
			<h2 class="text-2xl font-semibold mb-3">6. Acessibilidade e formulários</h2>
			<ul class="list-disc pl-6 text-gray-700">
				<li>Associe labels (for / id) a inputs</li>
				<li>Use aria-invalid, aria-describedby para erros</li>
				<li>Retorne foco para inputs com erro e anuncie mensagens por live region</li>
			</ul>
		</section>

		<section class="bg-white rounded-2xl shadow p-6 mb-6">
			<h2 class="text-2xl font-semibold mb-3">7. Tratamento de erros em handlers</h2>
			<p class="text-gray-700">Envolva lógica crítica em try/catch nos handlers async e isole efeitos colaterais para evitar que um erro quebre a interação inteira.</p>
			<div class="code-example p-4"><pre><code class="language-js">form.addEventListener('submit', async (e) =&gt; {
	e.preventDefault();
	try {
		const res = await fetch('/api', { method: 'POST' });
		if (!res.ok) throw new Error('Erro na requisição');
	} catch (err) {
		console.error(err);
		// mostrar mensagem de erro amigável
	}
});</code></pre></div>
		</section>

		<section class="bg-white rounded-2xl shadow p-6 mb-6">
			<h2 class="text-2xl font-semibold mb-3">8. Exercícios (sem soluções comentadas)</h2>
			<ol class="list-decimal pl-6 text-gray-700">
				<li>Implemente um formulário de cadastro com validação: nome (obrigatório), email (padrão), senha (min 8 caracteres) e feedback inline.</li>
				<li>Crie um componente de busca que filtra uma lista local com debounce de 250ms. Não remova/recrie elementos desnecessariamente.</li>
				<li>Implemente um modal acessível que trave o foco enquanto aberto e retorne o foco ao elemento que o abriu quando fechado.</li>
			</ol>
			<p class="text-gray-600 mt-3">Critérios: usabilidade, acessibilidade, performance e código modular nos handlers.</p>
		</section>

		<footer class="text-sm text-gray-600 mb-8">Aula aprofundada de Eventos e Formulários — sem soluções comentadas.</footer>
	</div>
</body>
</html>
